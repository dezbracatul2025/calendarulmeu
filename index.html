<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar Agenți</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
            margin: 0;
            padding: 20px;
        }
        .calendar { max-width: 1200px; margin: auto; }
        .week { display: flex; gap: 15px; }
        .day { padding: 15px; border: 1px solid #ccc; background: #f9fbfc; }
        .occupied { color: white; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Calendar Agenți</h1>
    <div id="login">
        <input type="text" id="agentID" placeholder="ID">
        <input type="password" id="password" placeholder="Parola">
        <button onclick="login()">Autentificare</button>
    </div>
    <div id="calendar" class="calendar" style="display:none;"></div>
    <script>
        const firebaseConfig = { /* Config Firebase */ };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref('bookings');
        const agents = { "Claudiu": "#ff5733", "Andreea": "#33ff57" };
        let currentUser = null;

        function login() {
            const id = document.getElementById("agentID").value;
            const pass = document.getElementById("password").value;
            if (pass === "MOTIVATIE") {
                currentUser = id;
                document.getElementById("login").style.display = "none";
                document.getElementById("calendar").style.display = "block";
                generateCalendar();
            }
        }

        function generateCalendar() {
            const calendar = document.getElementById("calendar");
            calendar.innerHTML = "";
            let today = new Date();
            let startDate = new Date(today.setDate(today.getDate() - today.getDay() + 1));
            for (let i = 0; i < 3; i++) {
                let weekDiv = document.createElement("div");
                weekDiv.classList.add("week");
                for (let j = 0; j < 5; j++) {
                    let date = new Date(startDate);
                    date.setDate(startDate.getDate() + j + (i * 7));
                    let dayDiv = document.createElement("div");
                    dayDiv.classList.add("day");
                    dayDiv.innerHTML = `<strong>${date.toDateString()}</strong>`;
                    weekDiv.appendChild(dayDiv);
                }
                calendar.appendChild(weekDiv);
            }
            loadBookings();
        }

        function loadBookings() {
            db.on('value', snapshot => {
                let data = snapshot.val() || {};
                document.querySelectorAll('.day').forEach(dayDiv => {
                    let date = dayDiv.innerText.trim();
                    Object.keys(data).forEach(key => {
                        if (key.includes(date)) {
                            let booking = data[key];
                            let div = document.createElement("div");
                            div.classList.add("occupied");
                            div.style.background = booking.color;
                            div.innerText = `${booking.hour} - ${booking.agent}`;
                            if (booking.agent === currentUser) {
                                div.onclick = () => db.child(key).remove();
                            }
                            dayDiv.appendChild(div);
                        }
                    });
                });
            });
        }
    </script>
</body>
</html>
